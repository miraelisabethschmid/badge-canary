name: Ensure Hero Assets

on:
  workflow_dispatch:   # sorgt dafür, dass der Run-Button erscheint

permissions:
  contents: write

concurrency:
  group: ensure-hero-assets
  cancel-in-progress: true

jobs:
  ensure-hero:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Ensure hero image placeholder
        shell: bash
        run: |
          set -e
          mkdir -p docs/portrait

          # Nur wenn noch nichts da ist – dann einfachen Platzhalter bauen
          if [ ! -s docs/portrait/mira-hero.svg ]; then
            cat > docs/portrait/mira-hero.svg << 'EOF'
<svg xmlns="http://www.w3.org/2000/svg" width="800" height="1200">
  <rect width="100%" height="100%" fill="#020617"/>
  <text x="50%" y="50%" fill="#e5e7eb" font-size="32" text-anchor="middle">
    Mira – Portrait Platzhalter
  </text>
</svg>
EOF
          else
            echo "docs/portrait/mira-hero.svg existiert bereits – nichts zu tun."
          fi

      - name: Commit hero assets (if changed)
        shell: bash
        run: |
          set -e
          git config user.name  "mira-auto"
          git config user.email "actions@users.noreply.github.com"

          git add docs/portrait/mira-hero.svg || true

          if git diff --cached --quiet; then
            echo "Keine Änderungen – kein Commit nötig."
            exit 0
          fi

          git commit -m "chore: ensure hero assets (placeholder svg)"
          git push
